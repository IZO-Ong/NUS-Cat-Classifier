import{g as P,r as l,j as t,L as ee,u as ae}from"./index-2CuIIo3H.js";import{c as h,u as y,a as se,b as te,B as re}from"./Button-CH1tyBuy.js";var S={exports:{}},k,_;function oe(){if(_)return k;_=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return k=e,k}var L,B;function ne(){if(B)return L;B=1;var e=oe();function a(){}function r(){}return r.resetWarningCache=a,L=function(){function s(c,i,d,p,f,m){if(m!==e){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}s.isRequired=s;function o(){return s}var n={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:o,element:s,elementType:s,instanceOf:o,node:s,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:r,resetWarningCache:a};return n.PropTypes=n,n},L}var q;function le(){return q||(q=1,S.exports=ne()()),S.exports}var ce=le();const F=P(ce),ie={type:F.string,tooltip:F.bool,as:F.elementType},$=l.forwardRef(({as:e="div",className:a,type:r="valid",tooltip:s=!1,...o},n)=>t.jsx(e,{...o,ref:n,className:h(a,`${r}-${s?"tooltip":"feedback"}`)}));$.displayName="Feedback";$.propTypes=ie;const v=l.createContext({}),I=l.forwardRef(({id:e,bsPrefix:a,className:r,type:s="checkbox",isValid:o=!1,isInvalid:n=!1,as:c="input",...i},d)=>{const{controlId:p}=l.useContext(v);return a=y(a,"form-check-input"),t.jsx(c,{...i,ref:d,type:s,id:e||p,className:h(r,a,o&&"is-valid",n&&"is-invalid")})});I.displayName="FormCheckInput";const T=l.forwardRef(({bsPrefix:e,className:a,htmlFor:r,...s},o)=>{const{controlId:n}=l.useContext(v);return e=y(e,"form-check-label"),t.jsx("label",{...s,ref:o,htmlFor:r||n,className:h(a,e)})});T.displayName="FormCheckLabel";function de(e,a){return l.Children.toArray(e).some(r=>l.isValidElement(r)&&r.type===a)}const A=l.forwardRef(({id:e,bsPrefix:a,bsSwitchPrefix:r,inline:s=!1,reverse:o=!1,disabled:n=!1,isValid:c=!1,isInvalid:i=!1,feedbackTooltip:d=!1,feedback:p,feedbackType:f,className:m,style:u,title:g="",type:w="checkbox",label:C,children:j,as:x="input",...N},Q)=>{a=y(a,"form-check"),r=y(r,"form-switch");const{controlId:O}=l.useContext(v),X=l.useMemo(()=>({controlId:e||O}),[O,e]),D=!j&&C!=null&&C!==!1||de(j,T),Z=t.jsx(I,{...N,type:w==="switch"?"checkbox":w,ref:Q,isValid:c,isInvalid:i,disabled:n,as:x});return t.jsx(v.Provider,{value:X,children:t.jsx("div",{style:u,className:h(m,D&&a,s&&`${a}-inline`,o&&`${a}-reverse`,w==="switch"&&r),children:j||t.jsxs(t.Fragment,{children:[Z,D&&t.jsx(T,{title:g,children:C}),p&&t.jsx($,{type:f,tooltip:d,children:p})]})})})});A.displayName="FormCheck";const R=Object.assign(A,{Input:I,Label:T}),U=l.forwardRef(({bsPrefix:e,type:a,size:r,htmlSize:s,id:o,className:n,isValid:c=!1,isInvalid:i=!1,plaintext:d,readOnly:p,as:f="input",...m},u)=>{const{controlId:g}=l.useContext(v);return e=y(e,"form-control"),t.jsx(f,{...m,type:a,size:s,ref:u,readOnly:p,id:o||g,className:h(n,d?`${e}-plaintext`:e,r&&`${e}-${r}`,a==="color"&&`${e}-color`,c&&"is-valid",i&&"is-invalid")})});U.displayName="FormControl";const pe=Object.assign(U,{Feedback:$}),W=l.forwardRef(({className:e,bsPrefix:a,as:r="div",...s},o)=>(a=y(a,"form-floating"),t.jsx(r,{ref:o,className:h(e,a),...s})));W.displayName="FormFloating";const b=l.forwardRef(({controlId:e,as:a="div",...r},s)=>{const o=l.useMemo(()=>({controlId:e}),[e]);return t.jsx(v.Provider,{value:o,children:t.jsx(a,{...r,ref:s})})});b.displayName="FormGroup";function me({as:e,bsPrefix:a,className:r,...s}){a=y(a,"col");const o=se(),n=te(),c=[],i=[];return o.forEach(d=>{const p=s[d];delete s[d];let f,m,u;typeof p=="object"&&p!=null?{span:f,offset:m,order:u}=p:f=p;const g=d!==n?`-${d}`:"";f&&c.push(f===!0?`${a}${g}`:`${a}${g}-${f}`),u!=null&&i.push(`order${g}-${u}`),m!=null&&i.push(`offset${g}-${m}`)}),[{...s,className:h(r,...c,...i)},{as:e,bsPrefix:a,spans:c}]}const V=l.forwardRef((e,a)=>{const[{className:r,...s},{as:o="div",bsPrefix:n,spans:c}]=me(e);return t.jsx(o,{...s,ref:a,className:h(r,!c.length&&n)})});V.displayName="Col";const G=l.forwardRef(({as:e="label",bsPrefix:a,column:r=!1,visuallyHidden:s=!1,className:o,htmlFor:n,...c},i)=>{const{controlId:d}=l.useContext(v);a=y(a,"form-label");let p="col-form-label";typeof r=="string"&&(p=`${p} ${p}-${r}`);const f=h(o,a,s&&"visually-hidden",r&&p);return n=n||d,r?t.jsx(V,{ref:i,as:"label",className:f,htmlFor:n,...c}):t.jsx(e,{ref:i,className:f,htmlFor:n,...c})});G.displayName="FormLabel";const M=l.forwardRef(({bsPrefix:e,className:a,id:r,...s},o)=>{const{controlId:n}=l.useContext(v);return e=y(e,"form-range"),t.jsx("input",{...s,type:"range",ref:o,className:h(a,e),id:r||n})});M.displayName="FormRange";const H=l.forwardRef(({bsPrefix:e,size:a,htmlSize:r,className:s,isValid:o=!1,isInvalid:n=!1,id:c,...i},d)=>{const{controlId:p}=l.useContext(v);return e=y(e,"form-select"),t.jsx("select",{...i,size:r,ref:d,className:h(s,e,a&&`${e}-${a}`,o&&"is-valid",n&&"is-invalid"),id:c||p})});H.displayName="FormSelect";const Y=l.forwardRef(({bsPrefix:e,className:a,as:r="small",muted:s,...o},n)=>(e=y(e,"form-text"),t.jsx(r,{...o,ref:n,className:h(a,e,s&&"text-muted")})));Y.displayName="FormText";const z=l.forwardRef((e,a)=>t.jsx(R,{...e,ref:a,type:"switch"}));z.displayName="Switch";const ue=Object.assign(z,{Input:R.Input,Label:R.Label}),J=l.forwardRef(({bsPrefix:e,className:a,children:r,controlId:s,label:o,...n},c)=>(e=y(e,"form-floating"),t.jsxs(b,{ref:c,className:h(a,e),controlId:s,...n,children:[r,t.jsx("label",{htmlFor:s,children:o})]})));J.displayName="FloatingLabel";const fe={_ref:F.any,validated:F.bool,as:F.elementType},E=l.forwardRef(({className:e,validated:a,as:r="form",...s},o)=>t.jsx(r,{...s,ref:o,className:h(e,a&&"was-validated")}));E.displayName="Form";E.propTypes=fe;const he=Object.assign(E,{Group:b,Control:pe,Floating:W,Check:R,Switch:ue,Label:G,Text:Y,Range:M,Select:H,FloatingLabel:J});function ye({imagePreview:e,setImagePreview:a,setPrediction:r,setLoading:s,setPendingFile:o}){const[n,c]=l.useState(!1),i=m=>{const u=new FileReader;u.onloadend=()=>{a(u.result),o(m),r(null)},u.readAsDataURL(m),o(m),r(null)},d=m=>{m.preventDefault(),c(!1);const u=m.dataTransfer.files[0];u&&i(u)},p=m=>{m.preventDefault(),c(m.type==="dragenter"||m.type==="dragover")},f=m=>{const u=m.target.files[0];u&&i(u)};return t.jsx(he.Group,{controlId:"formFile",className:"mb-3",children:t.jsxs("div",{className:`drop-zone ${n?"active":""}`,onDrop:d,onDragEnter:p,onDragOver:p,onDragLeave:()=>c(!1),children:[t.jsxs("div",{className:"upload-row",children:[t.jsx("span",{className:"fw-bold fs-5",children:e?"Upload another image:":"Upload your cat image here:"}),t.jsxs("label",{className:"custom-browse",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"hidden-file-input"}),"Browse"]})]}),t.jsx("p",{className:"text-muted small",children:"Or drag and drop image here"})]})})}function ge({imagePreview:e}){return e?t.jsx("div",{style:{marginTop:"1rem"},children:t.jsx("img",{src:e,alt:"Preview",width:300})}):null}const K=l.forwardRef(({bsPrefix:e,variant:a,animation:r="border",size:s,as:o="div",className:n,...c},i)=>{e=y(e,"spinner");const d=`${e}-${r}`;return t.jsx(o,{ref:i,...c,className:h(n,d,s&&`${d}-${s}`,a&&`text-${a}`)})});K.displayName="Spinner";function je({loading:e,prediction:a,onPredict:r,disabled:s,slug:o,error:n}){const[c,i]=l.useState(!1);l.useEffect(()=>{if(a){i(!1);const p=setTimeout(()=>i(!0),50);return()=>clearTimeout(p)}else i(!1)},[a]);const d=a&&a.toLowerCase()!=="not a cat";return t.jsx("div",{className:"predict-section",children:e?t.jsx(K,{animation:"border",role:"status",variant:"secondary",style:{width:"2.5rem",height:"2.5rem"}}):a?t.jsxs("h2",{className:`predict-text ${c?"visible":""}`,children:["Prediction:"," ",d?t.jsx(ee,{to:`/cats/${o}`,className:"predict-link",children:a}):a]}):t.jsxs("div",{className:"predict-button-block",children:[t.jsx(re,{variant:"primary",onClick:r,disabled:s,children:"Predict"}),n&&t.jsx("div",{className:"status-wrapper",children:t.jsxs("div",{className:"status-message error",children:["âŒ ",n]})})]})})}function xe(){const{imagePreview:e,setImagePreview:a,prediction:r,setPrediction:s,loading:o,setLoading:n,lastPredictedCat:c,setLastPredictedCat:i}=ae(),[d,p]=l.useState(null),[f,m]=l.useState(!1),[u,g]=l.useState(null),w="https://nus-cat-classifier.onrender.com";l.useEffect(()=>{const j=setTimeout(()=>{m(!0)},10);return()=>clearTimeout(j)},[]);const C=async()=>{if(!d)return;n(!0),g(null),s(null);const j=new FormData;j.append("image",d);try{const x=await fetch(`${w}/api/predict`,{method:"POST",body:j}),N=await x.json();if(!x.ok)throw new Error(N.error||"Prediction failed");s(N.prediction),N.prediction.toLowerCase()!=="not a cat"&&i({name:N.prediction,slug:N.slug})}catch(x){s(null),i(null),g(x.message||"Error fetching prediction")}finally{n(!1)}};return t.jsx("div",{className:`main-box text-center fade-ready ${f?"fade-in":""}`,children:t.jsxs("div",{className:"card-inner",children:[t.jsxs("h1",{className:"heading fade-delay-1",children:["NUS Cat Classifier ",t.jsx("span",{className:"emoji",children:"ðŸ±"})]}),t.jsx("div",{className:"fade-delay-2",children:t.jsx(ye,{imagePreview:e,setImagePreview:a,setPrediction:s,setLoading:n,setPendingFile:j=>{p(j),g(null),s(null)}})}),e&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fade-delay-3",children:t.jsx(ge,{imagePreview:e})}),t.jsx("div",{className:"fade-delay-4",children:t.jsx(je,{loading:o,prediction:r,onPredict:C,disabled:!d,slug:c==null?void 0:c.slug,error:u})})]})]})})}export{xe as default};
