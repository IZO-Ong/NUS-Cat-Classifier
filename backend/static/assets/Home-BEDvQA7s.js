import{g as P,r as l,j as s,L as ee,u as ae}from"./index-Dxn3p2JZ.js";import{c as h,u as y,a as te,b as se,B as re}from"./Button-BnQWeLN_.js";var R={exports:{}},$,E;function oe(){if(E)return $;E=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return $=e,$}var S,D;function ne(){if(D)return S;D=1;var e=oe();function a(){}function r(){}return r.resetWarningCache=a,S=function(){function t(c,d,i,p,f,m){if(m!==e){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function o(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:o,element:t,elementType:t,instanceOf:o,node:t,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:r,resetWarningCache:a};return n.PropTypes=n,n},S}var _;function le(){return _||(_=1,R.exports=ne()()),R.exports}var ce=le();const x=P(ce),ie={type:x.string,tooltip:x.bool,as:x.elementType},T=l.forwardRef(({as:e="div",className:a,type:r="valid",tooltip:t=!1,...o},n)=>s.jsx(e,{...o,ref:n,className:h(a,`${r}-${t?"tooltip":"feedback"}`)}));T.displayName="Feedback";T.propTypes=ie;const j=l.createContext({}),k=l.forwardRef(({id:e,bsPrefix:a,className:r,type:t="checkbox",isValid:o=!1,isInvalid:n=!1,as:c="input",...d},i)=>{const{controlId:p}=l.useContext(j);return a=y(a,"form-check-input"),s.jsx(c,{...d,ref:i,type:t,id:e||p,className:h(r,a,o&&"is-valid",n&&"is-invalid")})});k.displayName="FormCheckInput";const w=l.forwardRef(({bsPrefix:e,className:a,htmlFor:r,...t},o)=>{const{controlId:n}=l.useContext(j);return e=y(e,"form-check-label"),s.jsx("label",{...t,ref:o,htmlFor:r||n,className:h(a,e)})});w.displayName="FormCheckLabel";function de(e,a){return l.Children.toArray(e).some(r=>l.isValidElement(r)&&r.type===a)}const B=l.forwardRef(({id:e,bsPrefix:a,bsSwitchPrefix:r,inline:t=!1,reverse:o=!1,disabled:n=!1,isValid:c=!1,isInvalid:d=!1,feedbackTooltip:i=!1,feedback:p,feedbackType:f,className:m,style:u,title:g="",type:v="checkbox",label:F,children:N,as:J="input",...K},Q)=>{a=y(a,"form-check"),r=y(r,"form-switch");const{controlId:O}=l.useContext(j),X=l.useMemo(()=>({controlId:e||O}),[O,e]),b=!N&&F!=null&&F!==!1||de(N,w),Z=s.jsx(k,{...K,type:v==="switch"?"checkbox":v,ref:Q,isValid:c,isInvalid:d,disabled:n,as:J});return s.jsx(j.Provider,{value:X,children:s.jsx("div",{style:u,className:h(m,b&&a,t&&`${a}-inline`,o&&`${a}-reverse`,v==="switch"&&r),children:N||s.jsxs(s.Fragment,{children:[Z,b&&s.jsx(w,{title:g,children:F}),p&&s.jsx(T,{type:f,tooltip:i,children:p})]})})})});B.displayName="FormCheck";const C=Object.assign(B,{Input:k,Label:w}),q=l.forwardRef(({bsPrefix:e,type:a,size:r,htmlSize:t,id:o,className:n,isValid:c=!1,isInvalid:d=!1,plaintext:i,readOnly:p,as:f="input",...m},u)=>{const{controlId:g}=l.useContext(j);return e=y(e,"form-control"),s.jsx(f,{...m,type:a,size:t,ref:u,readOnly:p,id:o||g,className:h(n,i?`${e}-plaintext`:e,r&&`${e}-${r}`,a==="color"&&`${e}-color`,c&&"is-valid",d&&"is-invalid")})});q.displayName="FormControl";const pe=Object.assign(q,{Feedback:T}),A=l.forwardRef(({className:e,bsPrefix:a,as:r="div",...t},o)=>(a=y(a,"form-floating"),s.jsx(r,{ref:o,className:h(e,a),...t})));A.displayName="FormFloating";const L=l.forwardRef(({controlId:e,as:a="div",...r},t)=>{const o=l.useMemo(()=>({controlId:e}),[e]);return s.jsx(j.Provider,{value:o,children:s.jsx(a,{...r,ref:t})})});L.displayName="FormGroup";function me({as:e,bsPrefix:a,className:r,...t}){a=y(a,"col");const o=te(),n=se(),c=[],d=[];return o.forEach(i=>{const p=t[i];delete t[i];let f,m,u;typeof p=="object"&&p!=null?{span:f,offset:m,order:u}=p:f=p;const g=i!==n?`-${i}`:"";f&&c.push(f===!0?`${a}${g}`:`${a}${g}-${f}`),u!=null&&d.push(`order${g}-${u}`),m!=null&&d.push(`offset${g}-${m}`)}),[{...t,className:h(r,...c,...d)},{as:e,bsPrefix:a,spans:c}]}const U=l.forwardRef((e,a)=>{const[{className:r,...t},{as:o="div",bsPrefix:n,spans:c}]=me(e);return s.jsx(o,{...t,ref:a,className:h(r,!c.length&&n)})});U.displayName="Col";const W=l.forwardRef(({as:e="label",bsPrefix:a,column:r=!1,visuallyHidden:t=!1,className:o,htmlFor:n,...c},d)=>{const{controlId:i}=l.useContext(j);a=y(a,"form-label");let p="col-form-label";typeof r=="string"&&(p=`${p} ${p}-${r}`);const f=h(o,a,t&&"visually-hidden",r&&p);return n=n||i,r?s.jsx(U,{ref:d,as:"label",className:f,htmlFor:n,...c}):s.jsx(e,{ref:d,className:f,htmlFor:n,...c})});W.displayName="FormLabel";const V=l.forwardRef(({bsPrefix:e,className:a,id:r,...t},o)=>{const{controlId:n}=l.useContext(j);return e=y(e,"form-range"),s.jsx("input",{...t,type:"range",ref:o,className:h(a,e),id:r||n})});V.displayName="FormRange";const G=l.forwardRef(({bsPrefix:e,size:a,htmlSize:r,className:t,isValid:o=!1,isInvalid:n=!1,id:c,...d},i)=>{const{controlId:p}=l.useContext(j);return e=y(e,"form-select"),s.jsx("select",{...d,size:r,ref:i,className:h(t,e,a&&`${e}-${a}`,o&&"is-valid",n&&"is-invalid"),id:c||p})});G.displayName="FormSelect";const M=l.forwardRef(({bsPrefix:e,className:a,as:r="small",muted:t,...o},n)=>(e=y(e,"form-text"),s.jsx(r,{...o,ref:n,className:h(a,e,t&&"text-muted")})));M.displayName="FormText";const H=l.forwardRef((e,a)=>s.jsx(C,{...e,ref:a,type:"switch"}));H.displayName="Switch";const ue=Object.assign(H,{Input:C.Input,Label:C.Label}),Y=l.forwardRef(({bsPrefix:e,className:a,children:r,controlId:t,label:o,...n},c)=>(e=y(e,"form-floating"),s.jsxs(L,{ref:c,className:h(a,e),controlId:t,...n,children:[r,s.jsx("label",{htmlFor:t,children:o})]})));Y.displayName="FloatingLabel";const fe={_ref:x.any,validated:x.bool,as:x.elementType},I=l.forwardRef(({className:e,validated:a,as:r="form",...t},o)=>s.jsx(r,{...t,ref:o,className:h(e,a&&"was-validated")}));I.displayName="Form";I.propTypes=fe;const he=Object.assign(I,{Group:L,Control:pe,Floating:A,Check:C,Switch:ue,Label:W,Text:M,Range:V,Select:G,FloatingLabel:Y});function ye({imagePreview:e,setImagePreview:a,setPrediction:r,setLoading:t,setPendingFile:o}){const[n,c]=l.useState(!1),d=m=>{const u=new FileReader;u.onloadend=()=>{a(u.result),o(m),r(null)},u.readAsDataURL(m),o(m),r(null)},i=m=>{m.preventDefault(),c(!1);const u=m.dataTransfer.files[0];u&&d(u)},p=m=>{m.preventDefault(),c(m.type==="dragenter"||m.type==="dragover")},f=m=>{const u=m.target.files[0];u&&d(u)};return s.jsx(he.Group,{controlId:"formFile",className:"mb-3",children:s.jsxs("div",{className:`drop-zone ${n?"active":""}`,onDrop:i,onDragEnter:p,onDragOver:p,onDragLeave:()=>c(!1),children:[s.jsxs("div",{className:"upload-row",children:[s.jsx("span",{className:"fw-bold fs-5",children:e?"Upload another image:":"Upload your cat image here:"}),s.jsxs("label",{className:"custom-browse",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"hidden-file-input"}),"Browse"]})]}),s.jsx("p",{className:"text-muted small",children:"Or drag and drop image here"})]})})}function ge({imagePreview:e}){return e?s.jsx("div",{style:{marginTop:"1rem"},children:s.jsx("img",{src:e,alt:"Preview",width:300})}):null}const z=l.forwardRef(({bsPrefix:e,variant:a,animation:r="border",size:t,as:o="div",className:n,...c},d)=>{e=y(e,"spinner");const i=`${e}-${r}`;return s.jsx(o,{ref:d,...c,className:h(n,i,t&&`${i}-${t}`,a&&`text-${a}`)})});z.displayName="Spinner";function je({loading:e,prediction:a,onPredict:r,disabled:t,slug:o}){const[n,c]=l.useState(!1);l.useEffect(()=>{if(a){c(!1);const i=setTimeout(()=>c(!0),50);return()=>clearTimeout(i)}else c(!1)},[a]);const d=a&&a.toLowerCase()!=="not a cat";return s.jsx("div",{className:"predict-section",children:e?s.jsx(z,{animation:"border",role:"status",variant:"secondary",style:{width:"2.5rem",height:"2.5rem"}}):a?s.jsxs("h2",{className:`predict-text ${n?"visible":""}`,children:["Prediction:"," ",d?s.jsx(ee,{to:`/cats/${o}`,className:"predict-link",children:a}):a]}):s.jsx(re,{variant:"primary",onClick:r,disabled:t,children:"Predict"})})}function xe(){const{imagePreview:e,setImagePreview:a,prediction:r,setPrediction:t,loading:o,setLoading:n,lastPredictedCat:c,setLastPredictedCat:d}=ae(),[i,p]=l.useState(null),[f,m]=l.useState(!1),u="https://nus-cat-classifier.onrender.com";l.useEffect(()=>{const v=setTimeout(()=>{m(!0)},10);return()=>clearTimeout(v)},[]);const g=async()=>{if(!i)return;n(!0);const v=new FormData;v.append("image",i);try{const N=await(await fetch(`${u}/api/predict`,{method:"POST",body:v})).json();t(N.prediction),N.prediction.toLowerCase()!=="not a cat"&&d({name:N.prediction,slug:N.slug})}catch{t("Error fetching prediction")}finally{n(!1)}};return s.jsx("div",{className:`main-box text-center fade-ready ${f?"fade-in":""}`,children:s.jsxs("div",{className:"card-inner",children:[s.jsxs("h1",{className:"heading fade-delay-1",children:["NUS Cat Classifier ",s.jsx("span",{className:"emoji",children:"üê±"})]}),s.jsx("div",{className:"fade-delay-2",children:s.jsx(ye,{imagePreview:e,setImagePreview:a,setPrediction:t,setLoading:n,setPendingFile:p})}),e&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fade-delay-3",children:s.jsx(ge,{imagePreview:e})}),s.jsx("div",{className:"fade-delay-4",children:s.jsx(je,{loading:o,prediction:r,onPredict:g,disabled:!i,slug:c==null?void 0:c.slug})})]})]})})}export{xe as default};
