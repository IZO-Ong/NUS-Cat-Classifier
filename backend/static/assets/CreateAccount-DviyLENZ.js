import{r as t,v as b,j as s}from"./index-C43qB7ox.js";import{P as S}from"./Login-BVasVntd.js";function k(){const[a,i]=t.useState(""),[r,c]=t.useState(""),[u,l]=t.useState(""),[d,n]=t.useState(null),[m,g]=t.useState(null),[w,h]=t.useState(!1),[y,P]=t.useState(null),f=b(),p="https://nus-cat-classifier.onrender.com";t.useEffect(()=>{(localStorage.getItem("username")||sessionStorage.getItem("username"))&&f("/")},[]),t.useEffect(()=>{if(!a)return;h(!0);const e=setTimeout(async()=>{const C=(await(await fetch(`${p}/api/users`)).json()).some(N=>N.username===a);P(!C),h(!1)},400);return()=>clearTimeout(e)},[a]);function v(e){return e.length<6?"weak":e.match(/[0-9]/)&&e.match(/[A-Z]/)&&e.length>=8?"strong":"medium"}const j=async e=>{if(e.preventDefault(),n(null),g(null),r!==u){n("Passwords do not match");return}try{const o=await fetch(`${p}/api/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:r})}),x=await o.json();o.ok?(g("Account created successfully. Redirecting to login..."),i(""),c(""),l(""),setTimeout(()=>f("/login"),2e3)):n(x.error||"Signup failed")}catch{n("Network error. Please try again later.")}};return s.jsxs("form",{className:"login-form",onSubmit:j,children:[s.jsx("input",{type:"text",placeholder:"Username",value:a,onChange:e=>i(e.target.value),required:!0}),a&&s.jsx("div",{className:"username-status",children:w?"Checking availability...":y?"✅ Available":"❌ Taken"}),s.jsx(S,{value:r,onChange:e=>c(e.target.value),placeholder:"Password",required:!0}),r&&s.jsxs("div",{className:`password-strength ${v(r)}`,children:["Strength: ",v(r)]}),s.jsx(S,{value:u,onChange:e=>l(e.target.value),placeholder:"Confirm Password",required:!0,onKeyDown:e=>{(e.metaKey||e.ctrlKey)&&e.key==="Enter"&&j(e)}}),s.jsx("button",{type:"submit",children:"Create Account"}),d&&s.jsx("div",{className:"status-wrapper",children:s.jsx("div",{className:"status-message error",children:d})}),m&&s.jsx("div",{className:"status-wrapper",children:s.jsx("div",{className:"status-message loading",children:m})})]})}function T(){return s.jsxs("div",{className:"login-wrapper",children:[s.jsx("h2",{children:"Create Account"}),s.jsx(k,{})]})}export{T as default};
