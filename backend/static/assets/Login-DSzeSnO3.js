import{r as a,v as j,j as e,w as y,L as S}from"./index-Dxn3p2JZ.js";import{P as v}from"./Login-B8VmFSow.js";function w({setUsername:n}){const[s,o]=a.useState(""),[r,p]=a.useState(""),[m,x]=a.useState(!1),[u,i]=a.useState(null),d=j(),f="https://nus-cat-classifier.onrender.com";a.useEffect(()=>{(localStorage.getItem("username")||sessionStorage.getItem("username"))&&d("/")},[]);const g=async t=>{t.preventDefault(),i(null);try{const h=await fetch(`${f}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:r})}),l=await h.json();if(!h.ok)i(l.error||"Login failed");else{const c=m?localStorage:sessionStorage;c.setItem("token",l.token),c.setItem("username",s),c.setItem("userID",l.userID),n(s),d("/")}}catch{i("Network error. Please try again later.")}};return e.jsxs("form",{className:"login-form",onSubmit:g,children:[e.jsx("input",{type:"text",placeholder:"Username",value:s,onChange:t=>o(t.target.value),required:!0}),e.jsx(v,{value:r,onChange:t=>p(t.target.value),placeholder:"Password",required:!0,onKeyDown:t=>{(t.metaKey||t.ctrlKey)&&t.key==="Enter"&&g(t)}}),e.jsxs("label",{style:{fontSize:"0.9rem"},children:[e.jsx("input",{type:"checkbox",checked:m,onChange:t=>x(t.target.checked),style:{marginRight:"0.5rem"}}),"Remember me"]}),e.jsx("button",{type:"submit",children:"Login"}),u&&e.jsx("div",{className:"status-wrapper",children:e.jsx("div",{className:"status-message error",children:u})})]})}function k({setUsername:n}){var r;const o=(r=y().state)==null?void 0:r.timedOut;return e.jsxs("div",{className:"login-wrapper",children:[e.jsx("h2",{children:"Login"}),o&&e.jsx("div",{className:"status-wrapper",children:e.jsx("div",{className:"status-message error",children:"Your session has timed out. Please log in again."})}),e.jsx(w,{setUsername:n}),e.jsxs("div",{style:{marginTop:"1.5rem",textAlign:"center"},children:[e.jsx("span",{style:{fontSize:"0.95rem"},children:"Donâ€™t have an account? "}),e.jsx(S,{to:"/signup",style:{color:"#1e40af",fontWeight:500,textDecoration:"underline"},children:"Sign up here"})]})]})}export{k as default};
